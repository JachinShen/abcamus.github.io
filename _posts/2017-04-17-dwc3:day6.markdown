---
layout: post
title:  "dwc3 day6--conclusion"
author: Kai Qiu
date:   2017-04-17 21:22:37 +0800
categories: 嵌入式开发
tags: usb3
topics: dwc3验证套件
excerpt: usb3.0从链路层到协议层都调试通过了，做个小结。
---

* menu
{:toc}

> 自由固不是钱所能买到的，但能够为钱而卖掉。 —— 鲁迅

usb mass storage设备能顺利读写了，这样的话，对于ip来讲，从链路层到协议层起码是能正常工作的了。关于后面文章的安排：阶段性工作总结的文章就不写了，后面可能针对某些技术点重点罗嗦几句。

## 一、mass storage设备读写支持

[代码下载](https://github.com/abcamus/dwc3-portable)，驱动还是参考自uboot，通过`msg_write`和`msg_read`接口对设备进行读写，都能正常工作。

设备端具有一个bulk-in端点和一个bulk-out端点，协议是BBB（也就是Bulk Only Mass Storage）。

到这一步就能证明控制器从链路层到协议层都能正常工作了，其实也没必要做gadget驱动测试了，因为都是ip内部的东西，肯定是可以正常工作的。就算要测试，在现有的框架下也是很简单的事情，完成不会超过两天时间。

## 二、总结

其实整个验证过程前前后后大概有两个星期了，还算是比较顺利的，毕竟代码都有现成的，发扬一下拿来主义，再结合文档进行整理，在解决问题的过程中摸清整个工作原理。说实话，当前这份代码称为验证框架还不够格，因为验证最重要的是覆盖率的问题，可是现在没有重点考虑这个问题。

